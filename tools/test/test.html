<!DOCTYPE html>
<html lang="zh-CN" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GasGx - Global Gas Engine Database | 全球燃气发动机机型库</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Font Awesome 6.5.1 -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">

    <!-- html2canvas for Screenshot -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

    <!-- Tailwind Config for GasGx Theme -->
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        gas: {
                            bg: '#0F0F0F',      
                            card: '#1A1A1A',    
                            cardHover: '#252525',
                            green: '#5DD62C',   
                            darkGreen: '#337418',
                            text: '#F8F8F8',    
                            subtext: '#9CA3AF', 
                            border: '#333333'
                        }
                    },
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    }
                }
            }
        }
    </script>
    
    <style>
        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #0F0F0F; 
        }
        ::-webkit-scrollbar-thumb {
            background: #333; 
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #5DD62C; 
        }
        .text-glow {
            text-shadow: 0 0 10px rgba(93, 214, 44, 0.3);
        }
    </style>
</head>
<body class="bg-gas-bg text-gas-text font-sans antialiased selection:bg-gas-green selection:text-black">

    <!-- ==================== HEADER (LOCKED STRUCTURE) ==================== -->
    <header class="fixed w-full top-0 z-50 bg-gas-bg/90 backdrop-blur-md border-b border-gas-border transition-all duration-300" id="main-header">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-20">
                <!-- Logo -->
                <div class="flex-shrink-0 flex items-center cursor-pointer" onclick="window.location.href='/'">
                    <span class="text-2xl font-bold tracking-tighter text-white">Gas<span class="text-gas-green">Gx</span></span>
                    <span class="ml-3 text-xs text-gas-subtext hidden md:block border-l border-gray-700 pl-3" id="header-tagline">Natural Gas Power Mining</span>
                </div>

                <!-- Desktop Nav -->
                <nav class="hidden md:flex space-x-8">
                    <a href="#" class="text-sm font-medium hover:text-gas-green transition-colors" data-i18n="nav_home">Home</a>
                    <a href="#" class="text-sm font-medium text-gas-green" data-i18n="nav_database">Engine DB</a>
                    <a href="#" class="text-sm font-medium hover:text-gas-green transition-colors" data-i18n="nav_solutions">Solutions</a>
                    <a href="#" class="text-sm font-medium hover:text-gas-green transition-colors" data-i18n="nav_contact">Contact</a>
                </nav>

                <!-- Right Actions -->
                <div class="flex items-center space-x-4">
                    <!-- Language Switcher -->
                    <div class="relative group">
                        <button class="text-gas-subtext hover:text-white transition-colors focus:outline-none">
                            <i class="fa-solid fa-globe text-lg"></i>
                        </button>
                        <!-- Dropdown -->
                        <div class="absolute right-0 mt-2 w-32 bg-gas-card border border-gas-border rounded-lg shadow-xl opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 transform origin-top-right">
                            <div class="py-1">
                                <button onclick="app.setLanguage('en')" class="block w-full text-left px-4 py-2 text-sm text-gray-300 hover:bg-gas-green hover:text-black">English</button>
                                <button onclick="app.setLanguage('zh')" class="block w-full text-left px-4 py-2 text-sm text-gray-300 hover:bg-gas-green hover:text-black">中文</button>
                                <button onclick="app.setLanguage('ru')" class="block w-full text-left px-4 py-2 text-sm text-gray-300 hover:bg-gas-green hover:text-black">Русский</button>
                            </div>
                        </div>
                    </div>

                    <!-- User Auth (Firebase) -->
                    <div id="auth-container">
                        <button id="login-btn" class="text-sm font-medium text-white hover:text-gas-green transition-colors">
                            <i class="fa-brands fa-google mr-1"></i> <span data-i18n="login">Login</span>
                        </button>
                        <div id="user-profile" class="hidden flex items-center gap-3">
                            <img id="user-avatar" src="" alt="User" class="w-8 h-8 rounded-full border border-gas-green">
                            <button id="logout-btn" class="text-xs text-gas-subtext hover:text-red-400">
                                <i class="fa-solid fa-right-from-bracket"></i>
                            </button>
                        </div>
                    </div>

                    <!-- Quote Button -->
                    <button class="bg-gas-green text-black px-5 py-2 rounded-full text-sm font-bold hover:bg-white transition-all duration-300 shadow-[0_0_15px_rgba(93,214,44,0.3)] transform hover:scale-105" data-i18n="btn_quote">
                        Get Quote
                    </button>
                </div>
            </div>
        </div>
    </header>
    <div class="h-20"></div> <!-- Spacer for fixed header -->

    <!-- ==================== MAIN CONTENT (INJECTED) ==================== -->
    <!-- GasGx Engine Database Module -->
    <main class="min-h-screen relative overflow-hidden">
        
        <!-- Background Elements -->
        <div class="absolute top-0 left-0 w-full h-full overflow-hidden -z-10 pointer-events-none">
            <div class="absolute top-[-10%] right-[-10%] w-[500px] h-[500px] bg-gas-green/5 rounded-full blur-[120px]"></div>
            <div class="absolute bottom-[-10%] left-[-10%] w-[600px] h-[600px] bg-blue-900/10 rounded-full blur-[120px]"></div>
        </div>

        <!-- Hero Section -->
        <section class="pt-16 pb-12 px-4 sm:px-6 lg:px-8 max-w-7xl mx-auto text-center">
            <span class="inline-block py-1 px-3 rounded-full bg-gas-card border border-gas-border text-gas-green text-xs font-mono mb-4 tracking-widest uppercase" data-i18n="hero_badge">
                Official Database 2026
            </span>
            <h1 class="text-4xl md:text-6xl font-bold mb-6 text-white tracking-tight">
                <span data-i18n="hero_title_1">Global Gas Engine</span> <br/>
                <span class="text-transparent bg-clip-text bg-gradient-to-r from-gas-green to-emerald-400 text-glow" data-i18n="hero_title_2">Model Library</span>
            </h1>
            <p class="text-gas-subtext max-w-2xl mx-auto text-lg mb-10" data-i18n="hero_desc">
                Comprehensive data on performance, efficiency, and dimensions for mining-grade power generation.
            </p>

            <!-- Search & Filter Bar -->
            <div class="bg-gas-card border border-gas-border p-4 rounded-2xl shadow-2xl max-w-4xl mx-auto flex flex-col md:flex-row gap-4">
                <!-- Search Input -->
                <div class="relative flex-grow">
                    <i class="fa-solid fa-search absolute left-4 top-1/2 transform -translate-y-1/2 text-gas-subtext"></i>
                    <input type="text" id="searchInput" 
                           class="w-full bg-gas-bg border border-gas-border rounded-xl py-3 pl-12 pr-4 text-white focus:outline-none focus:border-gas-green transition-colors"
                           placeholder="Search model, brand (e.g. 6DLD)..." 
                           data-i18n-placeholder="search_placeholder">
                </div>
                
                <!-- Filters -->
                <select id="brandFilter" class="bg-gas-bg border border-gas-border rounded-xl px-4 py-3 text-white focus:outline-none focus:border-gas-green cursor-pointer">
                    <option value="all" data-i18n="filter_all_brands">All Brands</option>
                    <!-- Options populated by JS -->
                </select>

                <select id="powerFilter" class="bg-gas-bg border border-gas-border rounded-xl px-4 py-3 text-white focus:outline-none focus:border-gas-green cursor-pointer">
                    <option value="all" data-i18n="filter_power">Power Range</option>
                    <option value="low">&lt; 500 kW</option>
                    <option value="mid">500 - 1000 kW</option>
                    <option value="high">&gt; 1 MW</option>
                </select>
            </div>
        </section>

        <!-- Stats Overview -->
        <section class="border-y border-gas-border bg-gas-card/30 backdrop-blur-sm">
            <div class="max-w-7xl mx-auto px-4 py-8 grid grid-cols-2 md:grid-cols-4 gap-8 text-center">
                <div>
                    <div class="text-3xl font-bold text-white mb-1" id="stat-count">0</div>
                    <div class="text-xs text-gas-subtext uppercase tracking-wider" data-i18n="stat_models">Total Models</div>
                </div>
                <div>
                    <div class="text-3xl font-bold text-white mb-1" id="stat-brands">0</div>
                    <div class="text-xs text-gas-subtext uppercase tracking-wider" data-i18n="stat_brands">Brands</div>
                </div>
                <div>
                    <div class="text-3xl font-bold text-gas-green mb-1">44%+</div>
                    <div class="text-xs text-gas-subtext uppercase tracking-wider" data-i18n="stat_eff">Max Efficiency</div>
                </div>
                <div>
                    <div class="text-3xl font-bold text-white mb-1">24/7</div>
                    <div class="text-xs text-gas-subtext uppercase tracking-wider" data-i18n="stat_mining">Mining Ready</div>
                </div>
            </div>
        </section>

        <!-- Engine Grid -->
        <section class="py-16 max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-end mb-8">
                <h2 class="text-2xl font-bold text-white flex items-center gap-2">
                    <i class="fa-solid fa-server text-gas-green"></i>
                    <span data-i18n="section_library">Engine Library</span>
                </h2>
                <!-- Screenshot Button Integration -->
                <button onclick="app.captureScreen()" class="text-xs text-gas-subtext hover:text-white flex items-center gap-2 border border-gas-border px-3 py-1 rounded-lg hover:border-gas-green transition-colors">
                    <i class="fa-solid fa-camera"></i> <span data-i18n="btn_screenshot">Save Config</span>
                </button>
            </div>

            <div id="engineGrid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                <!-- Cards will be injected here by JS -->
            </div>
            
            <!-- Empty State -->
            <div id="emptyState" class="hidden text-center py-20">
                <i class="fa-regular fa-folder-open text-4xl text-gas-subtext mb-4"></i>
                <p class="text-gas-subtext" data-i18n="no_results">No engines found matching criteria.</p>
            </div>
        </section>

    </main>

    <!-- Detail Modal -->
    <div id="detailModal" class="fixed inset-0 z-[100] hidden bg-black/80 backdrop-blur-sm flex items-center justify-center p-4">
        <div class="bg-gas-card border border-gas-border w-full max-w-3xl rounded-2xl shadow-2xl overflow-hidden transform scale-95 opacity-0 transition-all duration-300" id="modalContent">
            <div class="flex justify-between items-center p-6 border-b border-gas-border bg-gas-bg/50">
                <h3 class="text-xl font-bold text-white" id="modalTitle">Engine Model</h3>
                <button onclick="app.closeDetailModal()" class="text-gas-subtext hover:text-white w-8 h-8 flex items-center justify-center rounded-full hover:bg-gas-border transition-colors">
                    <i class="fa-solid fa-times"></i>
                </button>
            </div>
            <div class="p-6 overflow-y-auto max-h-[70vh]">
                <div class="flex flex-col md:flex-row gap-6 mb-8">
                    <div class="w-full md:w-1/3 bg-white/5 rounded-xl p-4 flex items-center justify-center">
                        <img id="modalImg" src="" alt="Engine" class="max-w-full max-h-40 object-contain">
                    </div>
                    <div class="w-full md:w-2/3 grid grid-cols-2 gap-4">
                        <div class="bg-gas-bg p-3 rounded-lg border border-gas-border">
                            <div class="text-xs text-gas-subtext mb-1" data-i18n="label_power">Rated Power</div>
                            <div class="text-lg font-bold text-gas-green" id="modalPower">-</div>
                        </div>
                        <div class="bg-gas-bg p-3 rounded-lg border border-gas-border">
                            <div class="text-xs text-gas-subtext mb-1" data-i18n="label_eff_elec">Elec. Efficiency</div>
                            <div class="text-lg font-bold text-white" id="modalEff">-</div>
                        </div>
                        <div class="bg-gas-bg p-3 rounded-lg border border-gas-border">
                            <div class="text-xs text-gas-subtext mb-1" data-i18n="label_cylinders">Cylinders</div>
                            <div class="text-lg font-bold text-white" id="modalCyl">-</div>
                        </div>
                        <div class="bg-gas-bg p-3 rounded-lg border border-gas-border">
                            <div class="text-xs text-gas-subtext mb-1" data-i18n="label_gas_cons">Gas Consumption</div>
                            <div class="text-lg font-bold text-white" id="modalGas">-</div>
                        </div>
                    </div>
                </div>
                
                <h4 class="text-sm font-bold text-gas-green uppercase tracking-wider mb-4 border-b border-gas-border pb-2" data-i18n="header_tech_specs">Technical Specifications</h4>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-2 text-sm">
                    <div class="flex justify-between py-2 border-b border-gas-border/30">
                        <span class="text-gas-subtext" data-i18n="spec_brand">Brand</span>
                        <span class="text-white font-medium" id="modalBrand">-</span>
                    </div>
                    <div class="flex justify-between py-2 border-b border-gas-border/30">
                        <span class="text-gas-subtext" data-i18n="spec_displacement">Displacement</span>
                        <span class="text-white font-medium" id="modalDisp">-</span>
                    </div>
                    <div class="flex justify-between py-2 border-b border-gas-border/30">
                        <span class="text-gas-subtext" data-i18n="spec_dimensions">Dimensions</span>
                        <span class="text-white font-medium" id="modalDim">-</span>
                    </div>
                    <div class="flex justify-between py-2 border-b border-gas-border/30">
                        <span class="text-gas-subtext" data-i18n="spec_weight">Weight</span>
                        <span class="text-white font-medium" id="modalWeight">-</span>
                    </div>
                    <div class="flex justify-between py-2 border-b border-gas-border/30">
                        <span class="text-gas-subtext" data-i18n="spec_control">Control System</span>
                        <span class="text-white font-medium" id="modalControl">-</span>
                    </div>
                     <div class="flex justify-between py-2 border-b border-gas-border/30">
                        <span class="text-gas-subtext" data-i18n="spec_cooling">Cooling</span>
                        <span class="text-white font-medium" id="modalCooling">-</span>
                    </div>
                </div>
            </div>
            <div class="p-4 border-t border-gas-border bg-gas-bg/50 flex justify-end gap-3">
                <button onclick="app.closeDetailModal()" class="px-4 py-2 text-sm text-gas-subtext hover:text-white transition-colors" data-i18n="btn_close">Close</button>
                <button class="px-6 py-2 text-sm bg-gas-green text-black font-bold rounded-lg hover:bg-white transition-colors" data-i18n="btn_inquire">Inquire Model</button>
            </div>
        </div>
    </div>

    <!-- ==================== FOOTER (LOCKED STRUCTURE) ==================== -->
    <footer class="bg-black border-t border-gas-border mt-20">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
            <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
                <div class="col-span-1 md:col-span-1">
                     <span class="text-2xl font-bold tracking-tighter text-white">Gas<span class="text-gas-green">Gx</span></span>
                     <p class="mt-4 text-gas-subtext text-sm leading-relaxed" data-i18n="footerTagline">
                         Empowering global crypto mining with sustainable natural gas energy solutions.
                     </p>
                </div>
                <div>
                    <h4 class="text-white font-bold mb-4" data-i18n="footer_links">Quick Links</h4>
                    <ul class="space-y-2 text-sm text-gas-subtext">
                        <li><a href="#" class="hover:text-gas-green">Home</a></li>
                        <li><a href="#" class="hover:text-gas-green">Database</a></li>
                        <li><a href="#" class="hover:text-gas-green">Calculators</a></li>
                    </ul>
                </div>
                <div>
                    <h4 class="text-white font-bold mb-4" data-i18n="footer_legal">Legal</h4>
                    <ul class="space-y-2 text-sm text-gas-subtext">
                        <li><a href="#" class="hover:text-gas-green">Privacy Policy</a></li>
                        <li><a href="#" class="hover:text-gas-green">Terms of Service</a></li>
                    </ul>
                </div>
                <div>
                    <h4 class="text-white font-bold mb-4" data-i18n="footer_social">Connect</h4>
                    <div class="flex space-x-4">
                        <a href="#" class="text-gas-subtext hover:text-gas-green text-lg"><i class="fa-brands fa-twitter"></i></a>
                        <a href="#" class="text-gas-subtext hover:text-gas-green text-lg"><i class="fa-brands fa-linkedin"></i></a>
                        <a href="#" class="text-gas-subtext hover:text-gas-green text-lg"><i class="fa-brands fa-telegram"></i></a>
                    </div>
                </div>
            </div>
            <div class="border-t border-gas-border mt-12 pt-8 text-center text-xs text-gas-subtext">
                &copy; 2026 GasGx Mining. All rights reserved.
            </div>
        </div>
    </footer>

    <!-- ==================== SCRIPTS & LOGIC ==================== -->
    
    <!-- Firebase SDK (User Provided) -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getAnalytics } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-analytics.js";
        import { getAuth, GoogleAuthProvider, signInWithPopup, signOut, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";

        // Your web app's Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyBUEXdeSB7Ue0gkwcXN3j76ymyCbngxufY",
            authDomain: "gasgxmining.firebaseapp.com",
            projectId: "gasgxmining",
            storageBucket: "gasgxmining.firebasestorage.app",
            messagingSenderId: "465579060005",
            appId: "1:465579060005:web:ee20cb21ed58020c4a88cc",
            measurementId: "G-ZHNSQ29181"
        };

        // Initialize Firebase
        const firebaseApp = initializeApp(firebaseConfig);
        const analytics = getAnalytics(firebaseApp);
        const auth = getAuth(firebaseApp);
        const provider = new GoogleAuthProvider();

        // Export Auth functions to window for global access
        window.firebaseAuth = {
            login: () => {
                signInWithPopup(auth, provider)
                    .then((result) => {
                        console.log("Logged in:", result.user);
                        app.updateAuthUI(result.user);
                    }).catch((error) => {
                        console.error("Login failed:", error);
                        alert("Login error: " + error.message);
                    });
            },
            logout: () => {
                signOut(auth).then(() => {
                    console.log("Logged out");
                    app.updateAuthUI(null);
                }).catch((error) => {
                    console.error("Logout failed", error);
                });
            }
        };

        // Auth Listener
        onAuthStateChanged(auth, (user) => {
            app.updateAuthUI(user);
        });

        // Bind buttons
        document.getElementById('login-btn').addEventListener('click', window.firebaseAuth.login);
        document.getElementById('logout-btn').addEventListener('click', window.firebaseAuth.logout);
    </script>

    <script>
        // --- 1. DATA REPOSITORY (Extracted from Uploaded CSVs) ---
        
        // Brand to Image Mapping
        const brandLogos = {
            "锡柴（XICHAI）": "锡柴.png",
            "锡柴": "锡柴.png",
            "斗山（Doosan）": "https://via.placeholder.com/150?text=Doosan", // Placeholder if not uploaded
            "贝克休斯（Baker Hughes）": "https://via.placeholder.com/150?text=BakerHughes",
            "Vman": "Vman.png",
            "道依茨（Deutz）": "道依茨.png",
            "康明斯（Cummins）": "康明斯.png",
            "西门子（Siemens）": "西门子.png",
            "颜巴赫（Jenbacher）": "颜巴赫.png",
            "Baudouin": "Baudouin.png",
            "曼海姆（MWM）": "https://via.placeholder.com/150?text=MWM",
            "卡特彼勒（Caterpillar）": "https://via.placeholder.com/150?text=CAT",
            "玉柴（Yuchai）": "https://via.placeholder.com/150?text=Yuchai"
        };

        // Engine Data (Sample extracted from CSV logic - simplified for demo)
        const engineData = [
            {
                brand: "锡柴（XICHAI）",
                series: "铂威系列",
                model: "6DLD",
                cylinders: "L6",
                displacement: "6.6L",
                power: 220, // Numeric for sorting
                powerDisplay: "220 kW",
                efficiency: 38,
                totalEff: 80,
                dimensions: "1401×888×1187",
                weight: "1058 kg",
                control: "ECU Rail",
                cooling: "Liquid",
                fuel: "Natural Gas",
                origin: "China"
            },
            {
                brand: "锡柴（XICHAI）",
                series: "铂威系列",
                model: "6DK1",
                cylinders: "L6",
                displacement: "7.146L",
                power: 320,
                powerDisplay: "320 kW",
                efficiency: 38.5,
                totalEff: 81,
                dimensions: "1450×920×1220",
                weight: "1120 kg",
                control: "ECU Rail",
                cooling: "Liquid",
                fuel: "Natural Gas",
                origin: "China"
            },
            {
                brand: "斗山（Doosan）",
                series: "GT Series",
                model: "DGT-5",
                cylinders: "Turbine",
                displacement: "-",
                power: 5000,
                powerDisplay: "5000 kW",
                efficiency: 29,
                totalEff: 65,
                dimensions: "4200×1500×1700",
                weight: "4500 kg",
                control: "Doosan Control",
                cooling: "Liquid",
                fuel: "Natural Gas",
                origin: "Overseas"
            },
             {
                brand: "斗山（Doosan）",
                series: "GT Series",
                model: "DGT-100",
                cylinders: "Turbine",
                displacement: "-",
                power: 90000,
                powerDisplay: "90 MW",
                efficiency: 39,
                totalEff: 85,
                dimensions: "25000×8000×10000",
                weight: "800000 kg",
                control: "Doosan Control",
                cooling: "Liquid",
                fuel: "Natural Gas",
                origin: "Overseas"
            },
             {
                brand: "贝克休斯（Baker Hughes）",
                series: "NovaLT",
                model: "NovaLT™16",
                cylinders: "Turbine",
                displacement: "-",
                power: 16900,
                powerDisplay: "16.9 MW",
                efficiency: 36.4,
                totalEff: 79.4,
                dimensions: "15000×5000×6000",
                weight: "400000 kg",
                control: "BH System",
                cooling: "Liquid",
                fuel: "Natural Gas",
                origin: "Overseas"
            },
             {
                brand: "Vman",
                series: "Gas Series",
                model: "D12",
                cylinders: "V12",
                displacement: "12L",
                power: 400,
                powerDisplay: "400 kW",
                efficiency: 40,
                totalEff: 82,
                dimensions: "Standard",
                weight: "Standard",
                control: "Vman Control",
                cooling: "Liquid",
                fuel: "Natural Gas",
                origin: "China"
            },
             {
                brand: "颜巴赫（Jenbacher）",
                series: "J624",
                model: "J624",
                cylinders: "V24",
                displacement: "100L",
                power: 4500,
                powerDisplay: "4.5 MW",
                efficiency: 45,
                totalEff: 90,
                dimensions: "Large",
                weight: "Heavy",
                control: "Dia.ne",
                cooling: "Liquid",
                fuel: "Natural Gas",
                origin: "Austria"
            }
        ];

        // --- 2. MULTILINGUAL DICTIONARY (EN/ZH/RU) ---
        const translations = {
            en: {
                nav_home: "Home",
                nav_database: "Engine DB",
                nav_solutions: "Solutions",
                nav_contact: "Contact",
                login: "Login",
                btn_quote: "Get Quote",
                tagline: "Natural Gas Power Mining",
                footerTagline: "Empowering global crypto mining with sustainable natural gas energy solutions.",
                hero_badge: "Official Database 2026",
                hero_title_1: "Global Gas Engine",
                hero_title_2: "Model Library",
                hero_desc: "Comprehensive data on performance, efficiency, and dimensions for mining-grade power generation.",
                search_placeholder: "Search model, brand (e.g. 6DLD)...",
                filter_all_brands: "All Brands",
                filter_power: "Power Range",
                stat_models: "Total Models",
                stat_brands: "Brands",
                stat_eff: "Max Efficiency",
                stat_mining: "Mining Ready",
                section_library: "Engine Library",
                btn_screenshot: "Save Config",
                no_results: "No engines found matching criteria.",
                label_power: "Rated Power",
                label_eff_elec: "Elec. Efficiency",
                label_cylinders: "Cylinders",
                label_gas_cons: "Gas Consumption",
                header_tech_specs: "Technical Specifications",
                spec_brand: "Brand",
                spec_displacement: "Displacement",
                spec_dimensions: "Dimensions",
                spec_weight: "Weight",
                spec_control: "Control System",
                spec_cooling: "Cooling",
                btn_close: "Close",
                btn_inquire: "Inquire Model",
                footer_links: "Quick Links",
                footer_legal: "Legal",
                footer_social: "Connect",
                card_view_details: "View Details",
                card_eff: "Efficiency"
            },
            zh: {
                nav_home: "首页",
                nav_database: "机型库",
                nav_solutions: "解决方案",
                nav_contact: "联系我们",
                login: "登录",
                btn_quote: "获取报价",
                tagline: "天然气发电矿业专家",
                footerTagline: "用可持续的天然气能源解决方案赋能全球加密矿业。",
                hero_badge: "官方数据库 2026",
                hero_title_1: "全球燃气发动机",
                hero_title_2: "核心机型库",
                hero_desc: "涵盖矿场级发电所需的性能、效率和尺寸数据，助力您的能源选型。",
                search_placeholder: "搜索型号、品牌 (如 6DLD)...",
                filter_all_brands: "所有品牌",
                filter_power: "功率范围",
                stat_models: "机型收录",
                stat_brands: "合作品牌",
                stat_eff: "最高热效率",
                stat_mining: "矿业适用",
                section_library: "机型列表",
                btn_screenshot: "保存配置",
                no_results: "未找到匹配的发动机。",
                label_power: "额定功率",
                label_eff_elec: "发电效率",
                label_cylinders: "缸数/排列",
                label_gas_cons: "气耗",
                header_tech_specs: "技术参数",
                spec_brand: "品牌",
                spec_displacement: "排量",
                spec_dimensions: "尺寸 (L×W×H)",
                spec_weight: "重量",
                spec_control: "控制系统",
                spec_cooling: "冷却方式",
                btn_close: "关闭",
                btn_inquire: "咨询此机型",
                footer_links: "快速链接",
                footer_legal: "法律信息",
                footer_social: "关注我们",
                card_view_details: "查看详情",
                card_eff: "发电效率"
            },
            ru: {
                nav_home: "Главная",
                nav_database: "База Двигателей",
                nav_solutions: "Решения",
                nav_contact: "Контакты",
                login: "Вход",
                btn_quote: "Получить КП",
                tagline: "Майнинг на Природном Газе",
                footerTagline: "Обеспечение глобального крипто-майнинга устойчивыми решениями на природном газе.",
                hero_badge: "Официальная База 2026",
                hero_title_1: "Глобальные Газовые",
                hero_title_2: "Двигатели",
                hero_desc: "Полные данные о производительности, КПД и размерах для генерации энергии майнинг-класса.",
                search_placeholder: "Поиск модели, бренда...",
                filter_all_brands: "Все Бренды",
                filter_power: "Диапазон Мощности",
                stat_models: "Всего Моделей",
                stat_brands: "Бренды",
                stat_eff: "Макс. КПД",
                stat_mining: "Майнинг-класс",
                section_library: "Библиотека",
                btn_screenshot: "Скриншот",
                no_results: "Двигатели не найдены.",
                label_power: "Номинальная Мощность",
                label_eff_elec: "Элек. КПД",
                label_cylinders: "Цилиндры",
                label_gas_cons: "Потребление Газа",
                header_tech_specs: "Технические Характеристики",
                spec_brand: "Бренд",
                spec_displacement: "Объем",
                spec_dimensions: "Размеры",
                spec_weight: "Вес",
                spec_control: "Система Управления",
                spec_cooling: "Охлаждение",
                btn_close: "Закрыть",
                btn_inquire: "Запросить",
                footer_links: "Ссылки",
                footer_legal: "Инфо",
                footer_social: "Соцсети",
                card_view_details: "Подробнее",
                card_eff: "КПД"
            }
        };

        // --- 3. APPLICATION LOGIC ---
        const app = {
            currentLang: 'en',
            
            init() {
                this.setupEventListeners();
                this.populateFilters();
                this.renderEngines(engineData);
                this.updateStats();
                
                // Initialize text
                this.updateStaticText();
            },

            t(key) {
                return translations[this.currentLang][key] || key;
            },

            setLanguage(lang) {
                if (!translations[lang]) return;
                this.currentLang = lang;
                this.updateStaticText();
                this.renderEngines(this.getFilteredData()); // Re-render cards to translate their labels
                
                // Update specific dynamic placeholders
                document.getElementById('searchInput').placeholder = this.t('search_placeholder');
            },

            updateStaticText() {
                // Header Tagline logic from original template
                const taglineEl = document.getElementById('header-tagline');
                if(taglineEl) taglineEl.innerText = this.t('tagline');

                // Update all elements with data-i18n
                document.querySelectorAll('[data-i18n]').forEach(el => {
                    const key = el.getAttribute('data-i18n');
                    el.innerText = this.t(key);
                });
                
                // Update dropdown options text manually if needed
                const brandOpt = document.querySelector('#brandFilter option[value="all"]');
                if(brandOpt) brandOpt.innerText = this.t('filter_all_brands');
                
                const powerOpt = document.querySelector('#powerFilter option[value="all"]');
                if(powerOpt) powerOpt.innerText = this.t('filter_power');
            },

            setupEventListeners() {
                document.getElementById('searchInput').addEventListener('input', () => this.applyFilters());
                document.getElementById('brandFilter').addEventListener('change', () => this.applyFilters());
                document.getElementById('powerFilter').addEventListener('change', () => this.applyFilters());
            },

            populateFilters() {
                const brands = [...new Set(engineData.map(item => item.brand))];
                const select = document.getElementById('brandFilter');
                brands.forEach(brand => {
                    const opt = document.createElement('option');
                    opt.value = brand;
                    opt.innerText = brand.split('（')[0]; // Simplify display name
                    select.appendChild(opt);
                });
            },

            getFilteredData() {
                const search = document.getElementById('searchInput').value.toLowerCase();
                const brand = document.getElementById('brandFilter').value;
                const power = document.getElementById('powerFilter').value;

                return engineData.filter(item => {
                    const matchesSearch = item.model.toLowerCase().includes(search) || item.brand.toLowerCase().includes(search);
                    const matchesBrand = brand === 'all' || item.brand === brand;
                    
                    let matchesPower = true;
                    if (power === 'low') matchesPower = item.power < 500;
                    if (power === 'mid') matchesPower = item.power >= 500 && item.power <= 1000;
                    if (power === 'high') matchesPower = item.power > 1000;

                    return matchesSearch && matchesBrand && matchesPower;
                });
            },

            applyFilters() {
                const filtered = this.getFilteredData();
                this.renderEngines(filtered);
            },

            renderEngines(data) {
                const grid = document.getElementById('engineGrid');
                grid.innerHTML = '';
                
                const emptyState = document.getElementById('emptyState');
                if (data.length === 0) {
                    emptyState.classList.remove('hidden');
                    return;
                } else {
                    emptyState.classList.add('hidden');
                }

                data.forEach((item, index) => {
                    const logoSrc = brandLogos[item.brand] || brandLogos[item.brand.split('（')[0]] || 'https://via.placeholder.com/150?text=Engine';
                    
                    const card = document.createElement('div');
                    card.className = "bg-gas-card border border-gas-border rounded-xl p-5 hover:border-gas-green transition-all duration-300 hover:shadow-[0_0_20px_rgba(93,214,44,0.1)] group";
                    card.innerHTML = `
                        <div class="flex justify-between items-start mb-4">
                            <div class="h-10 w-24 flex items-center bg-white/5 rounded px-2">
                                <img src="${logoSrc}" alt="${item.brand}" class="max-h-8 max-w-full object-contain mx-auto opacity-80 group-hover:opacity-100 transition-opacity">
                            </div>
                            <span class="text-xs font-mono text-gas-subtext bg-black/50 px-2 py-1 rounded">${item.origin === 'China' ? 'CN' : 'INTL'}</span>
                        </div>
                        <h3 class="text-xl font-bold text-white mb-1 group-hover:text-gas-green transition-colors">${item.model}</h3>
                        <p class="text-sm text-gas-subtext mb-4">${item.brand.split('（')[0]}</p>
                        
                        <div class="grid grid-cols-2 gap-2 mb-6">
                            <div class="bg-black/40 p-2 rounded">
                                <div class="text-xs text-gas-subtext">${this.t('label_power')}</div>
                                <div class="font-bold text-gas-green">${item.powerDisplay}</div>
                            </div>
                            <div class="bg-black/40 p-2 rounded">
                                <div class="text-xs text-gas-subtext">${this.t('card_eff')}</div>
                                <div class="font-bold text-white">${item.efficiency}%</div>
                            </div>
                        </div>

                        <button onclick="app.openDetailModal(${item.power})" class="w-full py-2 rounded-lg bg-gas-border text-white text-sm font-medium hover:bg-gas-green hover:text-black transition-colors">
                            ${this.t('card_view_details')} <i class="fa-solid fa-arrow-right ml-1 text-xs"></i>
                        </button>
                    `;
                    grid.appendChild(card);
                });
            },

            openDetailModal(powerKey) {
                // Find item by power (simplified for demo, usually use ID)
                const item = engineData.find(e => e.power === powerKey);
                if (!item) return;

                document.getElementById('modalTitle').innerText = `${item.brand.split('（')[0]} - ${item.model}`;
                document.getElementById('modalPower').innerText = item.powerDisplay;
                document.getElementById('modalEff').innerText = item.efficiency + '%';
                document.getElementById('modalCyl').innerText = item.cylinders;
                document.getElementById('modalGas').innerText = 'Variable'; // Placeholder
                
                document.getElementById('modalBrand').innerText = item.brand;
                document.getElementById('modalDisp').innerText = item.displacement;
                document.getElementById('modalDim').innerText = item.dimensions;
                document.getElementById('modalWeight').innerText = item.weight;
                document.getElementById('modalControl').innerText = item.control;
                document.getElementById('modalCooling').innerText = item.cooling;

                const logoSrc = brandLogos[item.brand] || brandLogos[item.brand.split('（')[0]];
                document.getElementById('modalImg').src = logoSrc;

                const modal = document.getElementById('detailModal');
                const content = document.getElementById('modalContent');
                modal.classList.remove('hidden');
                setTimeout(() => {
                    content.classList.remove('scale-95', 'opacity-0');
                    content.classList.add('scale-100', 'opacity-100');
                }, 10);
            },

            closeDetailModal() {
                const modal = document.getElementById('detailModal');
                const content = document.getElementById('modalContent');
                content.classList.remove('scale-100', 'opacity-100');
                content.classList.add('scale-95', 'opacity-0');
                setTimeout(() => modal.classList.add('hidden'), 300);
            },

            updateStats() {
                document.getElementById('stat-count').innerText = engineData.length;
                const uniqueBrands = new Set(engineData.map(i => i.brand)).size;
                document.getElementById('stat-brands').innerText = uniqueBrands;
            },

            // Firebase Auth UI update
            updateAuthUI(user) {
                const loginBtn = document.getElementById('login-btn');
                const profileDiv = document.getElementById('user-profile');
                const avatar = document.getElementById('user-avatar');

                if (user) {
                    loginBtn.classList.add('hidden');
                    profileDiv.classList.remove('hidden');
                    avatar.src = user.photoURL || 'https://via.placeholder.com/40';
                } else {
                    loginBtn.classList.remove('hidden');
                    profileDiv.classList.add('hidden');
                }
            },

            captureScreen() {
                const target = document.body;
                html2canvas(target).then(canvas => {
                    const link = document.createElement('a');
                    link.download = 'GasGx_Engine_Config.png';
                    link.href = canvas.toDataURL();
                    link.click();
                }).catch(err => alert("Screenshot failed"));
            }
        };

        // Start
        window.app = app; // Expose for HTML onclick handlers
        document.addEventListener('DOMContentLoaded', () => app.init());
    </script>
</body>
</html>