<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GasGx - Oil Consumption Analytics</title>
    
    <!-- Libraries -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;900&family=Noto+Sans+SC:wght@300;400;500;700&display=swap" rel="stylesheet">
    <!-- html2canvas -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        gas: {
                            bg: '#0F0F0F',      
                            card: '#202020',    
                            green: '#5DD62C',   
                            darkGreen: '#337418',
                            text: '#F8F8F8',    
                            subtext: '#94a3b8'  
                        }
                    },
                    fontFamily: {
                        sans: ['Inter', 'Noto Sans SC', 'sans-serif'],
                        mono: ['Roboto Mono', 'monospace'],
                    },
                    boxShadow: {
                        'glow': '0 0 10px rgba(93, 214, 44, 0.3)',
                        'inner-input': 'inset 0 2px 4px 0 rgba(0, 0, 0, 0.6)',
                    }
                }
            }
        }
    </script>

    <style>
        :root { color-scheme: dark; }
        body {
            background-color: #0F0F0F;
            color: #F8F8F8;
            font-family: 'Inter', sans-serif;
            overflow-x: hidden;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }

        /* 滚动条 */
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: #0F0F0F; }
        ::-webkit-scrollbar-thumb { background: #333; border-radius: 3px; }
        ::-webkit-scrollbar-thumb:hover { background: #5DD62C; }

        /* 卡片磨砂效果 */
        .gas-card {
            background-color: rgba(32, 32, 32, 0.95);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        }
        
        /* 页面特定样式 */
        .content-card {
            background-color: rgba(32, 32, 32, 0.85);
            backdrop-filter: blur(16px);
            -webkit-backdrop-filter: blur(16px);
            border: 1px solid rgba(255, 255, 255, 0.05);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.5);
        }

        /* Mega Menu 动画 */
        .mega-menu {
            display: none;
            position: absolute;
            top: 100%;
            left: 0;
            width: 100%;
            background-color: #151515;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            padding: 1.5rem 0;
            box-shadow: 0 20px 40px rgba(0,0,0,0.5);
            z-index: 40;
        }

        .group:hover .mega-menu {
            display: block;
            animation: slideDown 0.2s ease-out;
        }

        /* Dropdown Menu 动画 */
        .dropdown-menu {
            display: none;
            position: absolute;
            top: 100%;
            min-width: 220px;
            background-color: #151515;
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 0 0 8px 8px;
            padding: 0.5rem 0;
            box-shadow: 0 10px 25px rgba(0,0,0,0.5);
            z-index: 40;
        }

        .group:hover .dropdown-menu {
            display: block;
            animation: slideDown 0.2s ease-out;
        }

        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .nav-item-link {
            position: relative;
            padding: 1.5rem 0.5rem;
            color: #94a3b8;
            transition: color 0.3s;
            white-space: nowrap;
            display: flex;
            align-items: center;
            gap: 4px;
        }
        .nav-item-link:hover { color: #5DD62C; }
        
        .nav-item-link::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 0;
            height: 2px;
            background-color: #5DD62C;
            transition: width 0.3s;
        }
        .nav-item-link:hover::after { width: 100%; }

        /* Input Styles */
        .gas-input {
            background-color: #1a1a1a;
            border: 1px solid #333;
            color: #F8F8F8;
            transition: all 0.3s ease;
            box-shadow: inset 0 2px 4px 0 rgba(0, 0, 0, 0.6);
        }
        .gas-input:focus {
            outline: none;
            border-color: #5DD62C;
            box-shadow: 0 0 0 3px rgba(93, 214, 44, 0.2), inset 0 2px 4px 0 rgba(0, 0, 0, 0.6);
        }

        /* Button Styling (Page Specific) */
        .gas-btn {
            background-color: transparent;
            border: 1px solid #444;
            color: #ccc;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .gas-btn:hover, .gas-btn.active {
            background-color: #5DD62C;
            border-color: #5DD62C;
            color: #0F0F0F;
            box-shadow: 0 0 15px rgba(93, 214, 44, 0.5);
            font-weight: 700;
        }

        /* Result Bubble */
        .result-bubble {
            background: linear-gradient(135deg, #202020 0%, #337418 100%);
            border: 1px solid rgba(93, 214, 44, 0.2);
        }

        /* Chart Container */
        .chart-container { position: relative; width: 100%; height: 400px; }

        /* Footer Link Hover */
        .footer-link {
            color: #94a3b8;
            transition: all 0.2s;
            font-size: 0.8rem;
            white-space: nowrap;
        }
        .footer-link:hover { color: #5DD62C; }

        /* Mobile Menu Styles */
        #mobile-menu-container { transition: transform 0.3s ease-in-out; }
        .mobile-submenu { max-height: 0; overflow: hidden; transition: max-height 0.3s ease-out; }
        .footer-accordion-content { max-height: 0; overflow: hidden; transition: max-height 0.3s ease-out; }
        
        /* Floating Share Button Animation */
        @keyframes floatPulse {
            0% { box-shadow: 0 0 0 0 rgba(93, 214, 44, 0.4); }
            70% { box-shadow: 0 0 0 10px rgba(93, 214, 44, 0); }
            100% { box-shadow: 0 0 0 0 rgba(93, 214, 44, 0); }
        }
        .float-btn { animation: floatPulse 2s infinite; }
    </style>
</head>
<body class="flex flex-col min-h-screen relative">

    <!-- Header -->
    <header class="fixed top-0 w-full z-50 gas-card h-16 transition-all duration-300">
        <div class="max-w-[1800px] mx-auto px-4 h-full flex justify-between items-center relative">
            
            <!-- Left: Logo + Page Title -->
            <div class="flex items-center gap-3 w-auto shrink-0 mr-4">
                <a href="/index.html" class="flex items-center gap-2 group">
                    <h1 class="text-2xl font-bold tracking-wider text-gas-green hover:text-white transition-colors cursor-pointer">GasGx</h1>
                </a>
                
                <!-- Page Title (Desktop) -->
                <div class="hidden md:flex flex-col justify-center border-l border-gray-700 pl-3 h-8">
                    <span class="text-white text-sm font-bold tracking-wide uppercase" data-i18n="pageTitle">Oil Consumption Analytics</span>
                </div>
            </div>

            <!-- Center: Desktop Navigation -->
            <nav id="desktop-nav" class="hidden lg:flex items-center justify-center gap-2 xl:gap-6 h-full flex-1">
                <!-- JS Generated -->
            </nav>

            <!-- Right: Language & Mobile Toggle -->
            <div class="flex items-center gap-4 w-auto shrink-0 justify-end ml-4">
                <!-- Language Switcher (Desktop) -->
                <div class="hidden sm:flex items-center gap-1 bg-[#111] border border-white/10 rounded-full px-1 py-1">
                    <button onclick="app.setLanguage('zh')" id="btn-lang-zh" class="px-2 py-1 rounded-full text-[10px] font-medium transition-all w-8 text-center text-gas-subtext">CN</button>
                    <button onclick="app.setLanguage('en')" id="btn-lang-en" class="px-2 py-1 rounded-full text-[10px] font-bold transition-all w-8 text-center text-black bg-gas-green shadow-glow">EN</button>
                    <button onclick="app.setLanguage('ru')" id="btn-lang-ru" class="px-2 py-1 rounded-full text-[10px] font-medium transition-all w-8 text-center text-gas-subtext">RU</button>
                </div>

                <!-- Mobile Menu Button -->
                <button id="mobile-menu-btn" onclick="app.toggleMobileMenu()" class="lg:hidden p-2 text-white hover:text-gas-green text-xl focus:outline-none z-50 relative">
                    <i class="fa-solid fa-bars"></i>
                </button>
            </div>
        </div>
    </header>

    <!-- Mobile Navigation Overlay -->
    <div id="mobile-menu-container" class="fixed inset-0 z-40 bg-[#111] transform translate-x-full pt-20 px-4 pb-8 overflow-y-auto lg:hidden">
        <!-- Mobile Lang Switcher -->
        <div class="flex justify-center gap-4 mb-6 border-b border-white/10 pb-4">
            <div class="flex items-center gap-2 bg-[#222] border border-white/10 rounded-full px-1 py-1">
                <button onclick="app.setLanguage('zh')" id="mob-btn-lang-zh" class="px-4 py-2 rounded-full text-xs font-bold transition-all text-gray-400">CN</button>
                <button onclick="app.setLanguage('en')" id="mob-btn-lang-en" class="px-4 py-2 rounded-full text-xs font-medium transition-all text-black bg-gas-green">EN</button>
                <button onclick="app.setLanguage('ru')" id="mob-btn-lang-ru" class="px-4 py-2 rounded-full text-xs font-medium transition-all text-gray-400">RU</button>
            </div>
        </div>
        <nav id="mobile-nav-content" class="flex flex-col space-y-1">
            <!-- JS Generated Mobile Nav -->
        </nav>
    </div>

    <!-- Main Content Area -->
    <main class="flex-grow pt-24 pb-12 px-4 sm:px-6 lg:px-8 max-w-7xl mx-auto w-full min-h-[80vh]">
        
        <!-- Hero Section -->
        <div class="text-center mb-12 relative">
             <!-- Glow Effect -->
             <div class="absolute top-0 left-1/2 transform -translate-x-1/2 w-full h-full pointer-events-none opacity-20">
                <div class="absolute top-[-50%] left-[20%] w-[600px] h-[600px] bg-gas-green rounded-full blur-[120px]"></div>
            </div>
            
            <div class="relative z-10">
                <h1 class="text-4xl sm:text-5xl font-extrabold text-white tracking-tight mb-6">
                    <span class="text-gas-green" style="text-shadow: 0 0 20px rgba(93,214,44,0.3);">GasGx</span> <span data-i18n="heroTitle">Oil Consumption Analytics</span>
                </h1>
                <p class="mt-4 text-lg text-gas-subtext max-w-2xl mx-auto leading-relaxed" data-i18n="heroDesc">
                    Advanced analysis of MWM, Jenbacher, CAT, and other major gas engines. Optimize your OPEX with precision data.
                </p>
                <div class="mt-8 flex justify-center gap-4 flex-wrap">
                    <div class="flex items-center gap-2 px-5 py-2 rounded-full border border-gas-green/30 bg-gas-green/5 text-gas-green text-sm font-bold shadow-glow">
                        <i class="fa-solid fa-arrow-trend-down"></i> <span data-i18n="badgeLow">Lower is Better (OPEX)</span>
                    </div>
                    <div class="flex items-center gap-2 px-5 py-2 rounded-full border border-white/10 bg-white/5 text-gray-300 text-sm font-bold hover:bg-white/10 transition-colors">
                        <i class="fa-solid fa-clock-rotate-left"></i> <span data-i18n="badgeInterval">Oil Change Interval</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Dashboard Chart -->
        <section class="mb-12">
            <div class="content-card rounded-2xl p-6 sm:p-8">
                <div class="flex flex-col sm:flex-row justify-between items-center mb-6 gap-4">
                    <h2 class="text-xl font-bold text-white flex items-center gap-3">
                        <div class="w-1.5 h-6 bg-gas-green rounded-full shadow-[0_0_8px_#5DD62C]"></div>
                        <span data-i18n="chartTitle">Consumption Comparison (g/kWh)</span>
                    </h2>
                    
                    <!-- Filters -->
                    <div class="flex gap-2 bg-black/30 p-1 rounded-xl">
                        <button onclick="updateChart('all')" id="btn-all" class="gas-btn px-4 py-1.5 rounded-lg text-xs sm:text-sm uppercase tracking-wider active" data-i18n="btnAll">All</button>
                        <button onclick="updateChart('import')" id="btn-import" class="gas-btn px-4 py-1.5 rounded-lg text-xs sm:text-sm uppercase tracking-wider" data-i18n="btnImport">Import</button>
                        <button onclick="updateChart('domestic')" id="btn-domestic" class="gas-btn px-4 py-1.5 rounded-lg text-xs sm:text-sm uppercase tracking-wider" data-i18n="btnDomestic">Domestic</button>
                    </div>
                </div>

                <div class="chart-container">
                    <canvas id="oilChart"></canvas>
                </div>
                <p class="text-center text-xs text-gas-subtext mt-4 font-mono opacity-60" data-i18n="chartNote">// Data based on >300kW Standard Conditions</p>
            </div>
        </section>

        <!-- Calculator Section -->
        <section class="mb-12">
            <div class="content-card rounded-2xl p-1">
                <div class="bg-[#121212]/80 backdrop-blur rounded-xl p-6 sm:p-10">
                    <div class="text-center mb-8">
                        <h2 class="text-2xl font-bold text-white mb-2" data-i18n="calcTitle">Cost Savings Simulator</h2>
                        <p class="text-sm text-gas-subtext" data-i18n="calcDesc">Calculate financial impact of 0.1 g/kWh efficiency difference.</p>
                    </div>

                    <div class="flex justify-center mb-8">
                        <div class="inline-flex bg-black/60 p-1.5 rounded-xl border border-white/5">
                            <label class="cursor-pointer px-6 py-2 rounded-lg transition-all has-[:checked]:bg-gas-green has-[:checked]:text-black has-[:checked]:shadow-glow text-gray-400 font-medium">
                                <input type="radio" name="diffOption" value="0.2" class="hidden" checked onchange="calculateSavings()">
                                <span class="text-sm">0.2 g/kWh <span class="opacity-70 text-xs ml-1">(vs Std)</span></span>
                            </label>
                            <label class="cursor-pointer px-6 py-2 rounded-lg transition-all has-[:checked]:bg-gas-green has-[:checked]:text-black has-[:checked]:shadow-glow text-gray-400 font-medium">
                                <input type="radio" name="diffOption" value="0.3" class="hidden" onchange="calculateSavings()">
                                <span class="text-sm">0.3 g/kWh <span class="opacity-70 text-xs ml-1">(vs Old)</span></span>
                            </label>
                        </div>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                        <div>
                            <label class="block text-xs font-bold text-gas-green uppercase tracking-wider mb-3" data-i18n="labelPower">Power (kW)</label>
                            <input type="number" id="input-power" value="1000" class="gas-input w-full p-4 rounded-xl font-mono text-lg" oninput="calculateSavings()">
                        </div>
                        <div>
                            <label class="block text-xs font-bold text-gas-green uppercase tracking-wider mb-3" data-i18n="labelHours">Hours/Year</label>
                            <input type="number" id="input-hours" value="8322" class="gas-input w-full p-4 rounded-xl font-mono text-lg" oninput="calculateSavings()">
                        </div>
                        <div>
                            <label class="block text-xs font-bold text-gas-green uppercase tracking-wider mb-3" data-i18n="labelPrice">Oil Price ($/L)</label>
                            <input type="number" id="input-price" value="30" class="gas-input w-full p-4 rounded-xl font-mono text-lg" oninput="calculateSavings()">
                        </div>
                    </div>

                    <div class="result-bubble rounded-xl p-6 sm:p-8 relative overflow-hidden group">
                        <div class="absolute -right-10 -top-10 w-48 h-48 bg-white/10 rounded-full blur-3xl group-hover:bg-white/20 transition-all duration-500"></div>
                        <div class="grid grid-cols-1 sm:grid-cols-2 gap-8 relative z-10">
                            <div>
                                <h4 class="text-xs font-bold text-white/80 uppercase tracking-wide mb-1" data-i18n="resVol">Oil Volume Saved</h4>
                                <div class="flex items-baseline gap-2">
                                    <span id="result-oil-diff" class="text-4xl sm:text-5xl font-mono font-black text-white drop-shadow-lg">0</span>
                                    <span class="text-lg text-gas-green font-bold">L</span>
                                </div>
                            </div>
                            <div class="sm:text-right">
                                <h4 class="text-xs font-bold text-white/80 uppercase tracking-wide mb-1" data-i18n="resMoney">Annual Cost Saved</h4>
                                <div class="flex items-baseline gap-2 sm:justify-end">
                                    <span class="text-2xl text-gas-green font-bold">$</span>
                                    <span id="result-money-diff" class="text-5xl sm:text-6xl font-mono font-black text-white drop-shadow-[0_2px_4px_rgba(0,0,0,0.5)]">0</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Data Table -->
        <section class="mb-12">
            <div class="content-card rounded-xl overflow-hidden">
                <div class="overflow-x-auto">
                    <table class="min-w-full divide-y divide-white/10">
                        <thead class="bg-white/5 backdrop-blur-md">
                            <tr>
                                <th class="px-6 py-4 text-left text-xs font-bold text-gas-green uppercase tracking-wider" data-i18n="colBrand">Brand</th>
                                <th class="px-6 py-4 text-left text-xs font-bold text-gray-400 uppercase tracking-wider" data-i18n="colModel">Model</th>
                                <th class="px-6 py-4 text-left text-xs font-bold text-gray-400 uppercase tracking-wider" data-i18n="colPower">Power</th>
                                <th class="px-6 py-4 text-left text-xs font-bold text-gas-green uppercase tracking-wider" data-i18n="colOil">Oil (g/kWh)</th>
                            </tr>
                        </thead>
                        <tbody class="divide-y divide-white/5" id="table-body"></tbody>
                    </table>
                </div>
            </div>
        </section>
    </main>

    <!-- Footer -->
    <footer class="bg-[#0a0a0a] border-t border-white/10 mt-auto pt-10 pb-8 relative z-10">
        <div class="max-w-[1800px] mx-auto px-6">
            <div class="flex flex-col md:flex-row justify-between items-start mb-8 pb-6 border-b border-white/5">
                <div class="mb-6 md:mb-0">
                    <div class="flex items-center gap-2 mb-2">
                        <span class="text-2xl font-bold text-gas-green">GasGx</span>
                    </div>
                    <p class="text-sm text-gray-400 font-medium" data-i18n="footerTagline">Making natural gas power mining easier</p>
                </div>
                <div class="flex flex-col md:items-end space-y-2">
                    <h4 class="text-white font-bold text-sm uppercase tracking-wider mb-1" data-i18n="联系我们">Contact Us</h4>
                    <a href="mailto:contact@gasgx.com" class="text-sm text-gray-400 hover:text-gas-green flex items-center gap-2 transition-colors">
                        <i class="fa-solid fa-envelope"></i> contact@gasgx.com
                    </a>
                    <div class="text-sm text-gray-400 flex items-center gap-2">
                        <i class="fa-brands fa-weixin"></i> <span class="hover:text-gas-green cursor-pointer">www_gasgx_com</span>
                    </div>
                </div>
            </div>
            <div id="footer-links" class="mb-10 space-y-2"></div>
            <div class="flex flex-col md:flex-row justify-between items-center gap-6 pt-6 border-t border-white/5">
                <div class="text-xs text-gray-600">© 2026 GasGx. All rights reserved.</div>
                <div class="flex gap-4">
                    <a href="#" target="_blank" class="text-gray-500 hover:text-gas-green transition-colors"><i class="fa-brands fa-tiktok text-lg"></i></a>
                    <a href="#" target="_blank" class="text-gray-500 hover:text-gas-green transition-colors"><i class="fa-brands fa-linkedin text-lg"></i></a>
                    <a href="#" target="_blank" class="text-gray-500 hover:text-gas-green transition-colors"><i class="fa-brands fa-facebook text-lg"></i></a>
                    <a href="#" target="_blank" class="text-gray-500 hover:text-gas-green transition-colors"><i class="fa-brands fa-weixin text-lg"></i></a>
                    <a href="#" target="_blank" class="text-gray-500 hover:text-gas-green transition-colors"><i class="fa-brands fa-x-twitter text-lg"></i></a>
                    <a href="#" target="_blank" class="text-gray-500 hover:text-gas-green transition-colors"><i class="fa-brands fa-youtube text-lg"></i></a>
                    <a href="#" target="_blank" class="text-gray-500 hover:text-gas-green transition-colors"><i class="fa-brands fa-telegram text-lg"></i></a>
                </div>
            </div>
        </div>
    </footer>

    <!-- Floating Share Button -->
    <button onclick="app.captureAndShare()" class="float-btn fixed right-6 top-1/2 -translate-y-1/2 w-12 h-12 bg-[#202020] border border-gas-green text-gas-green rounded-full shadow-lg flex items-center justify-center hover:bg-gas-green hover:text-black transition-all z-50 group" title="Share Snapshot">
        <i class="fa-solid fa-camera text-xl"></i>
        <span class="absolute right-14 bg-black text-white text-xs px-2 py-1 rounded opacity-0 group-hover:opacity-100 transition-opacity whitespace-nowrap border border-white/10">Share Page</span>
    </button>

    <!-- Back to Top -->
    <button onclick="window.scrollTo({top:0, behavior:'smooth'})" id="backToTopBtn" class="fixed bottom-6 right-6 bg-gas-green text-black w-10 h-10 rounded-full shadow-[0_0_15px_rgba(93,214,44,0.5)] flex items-center justify-center translate-y-20 opacity-0 transition-all duration-300 hover:scale-110 z-40 cursor-pointer">
        <i class="fa-solid fa-arrow-up"></i>
    </button>

    <!-- Share Modal -->
    <div id="shareModal" class="fixed inset-0 z-[100] bg-black/80 backdrop-blur-sm hidden flex items-center justify-center p-4">
        <div class="bg-[#202020] border border-gas-green/30 rounded-xl p-6 max-w-sm w-full shadow-2xl transform transition-all scale-95 opacity-0" id="shareModalContent">
            <div class="text-center mb-6">
                <div class="w-16 h-16 bg-gas-green/10 rounded-full flex items-center justify-center mx-auto mb-4">
                    <i class="fa-solid fa-check text-2xl text-gas-green"></i>
                </div>
                <h3 class="text-xl font-bold text-white mb-2">Snapshot Generated!</h3>
                <p class="text-sm text-gray-400">Full page captured successfully.</p>
            </div>
            <button onclick="app.closeModal()" class="w-full py-2 rounded-lg bg-white/10 text-white hover:bg-white/20 transition-colors text-sm font-medium">Close</button>
        </div>
    </div>

    <!-- Application Logic -->
    <script>
        // --- PAGE DATA ---
        const engineData = [
            { id: 1, brand: 'MWM', model: 'TCG 3016', power: '400-1000 kW', val: 0.10, category: 'import' },
            { id: 2, brand: 'MWM', model: 'TCG 3020', power: '1.4-2.3 MW', val: 0.15, category: 'import' },
            { id: 17, brand: 'CAT', model: 'CG 132/170', power: '400-2300 kW', val: 0.15, category: 'import' },
            { id: 3, brand: 'MWM', model: 'TCG 2032', power: '3.0-4.5 MW', val: 0.20, category: 'import' },
            { id: 6, brand: 'Jenbacher', model: 'Type 9', power: '10 MW+', val: 0.20, category: 'import' },
            { id: 10, brand: 'Yuchai', model: 'YC6K', power: '300-400 kW', val: 0.20, category: 'domestic' },
            { id: 7, brand: 'Weichai', model: '6M33', power: '500-600 kW', val: 0.20, category: 'domestic' },
            { id: 4, brand: 'Jenbacher', model: 'Type 3 / 4', power: '300-1500 kW', val: 0.25, category: 'import' },
            { id: 12, brand: 'Hanma', model: 'HMT13F.408', power: '300 kW+', val: 0.30, category: 'domestic' },
            { id: 14, brand: 'Sinotruk', model: 'MT13/T12', power: '300-450 kW', val: 0.30, category: 'domestic' },
            { id: 16, brand: 'CAT', model: 'G3500', power: '1-4.5 MW', val: 0.35, category: 'import' },
            { id: 9, brand: 'Weichai', model: 'WP/WH', power: '300 kW+', val: 0.40, category: 'domestic' }
        ];

        let myChart = null;

        const AppData = {
            navigation: [
                { title: "首页", path: "/index.html", type: "link", icon: "fa-solid fa-house" },
                {
                    title: "解决方案", path: "/solutions", type: "menu",
                    children: [
                        { title: "油气井/伴生气发电", path: "/solutions/oilfield" },
                        { title: "工业园区与分布式能源", path: "/solutions/industrial" },
                        { title: "数据中心 / 挖矿电力", path: "/solutions/mining" },
                        { title: "热电联供 CHP", path: "/solutions/chp" }
                    ]
                },
                {
                    title: "机型库", path: "/products", type: "mega",
                    sections: [
                        { header: "按功率分类", items: [{ title: "小于 500 kW", path: "/products/power-range/0-500kw" }, { title: "500 – 1,000 kW", path: "/products/power-range/500-1000kw" }, { title: "1 MW 以上", path: "/products/power-range/1mw-plus" }] },
                        { header: "按冷却方式", items: [{ title: "风冷", path: "/products/cooling/air" }, { title: "液冷", path: "/products/cooling/liquid" }] },
                        { header: "按气源类型", items: [{ title: "天然气", path: "/products/gas/natural" }, { title: "伴生气", path: "/products/gas/associated" }, { title: "低甲烷值气", path: "/products/gas/low-methane" }] },
                        { header: "按部署形式", items: [{ title: "集装箱机组", path: "/products/deployment/container" }, { title: "一体化机组 AIS", path: "/products/deployment/ais" }, { title: "滑撬式机组", path: "/products/deployment/skid" }] },
                        { header: "按品牌", items: [{ title: "全部品牌", path: "/products/brands" }, { title: "中国生产", path: "/products/brands/china" }, { title: "海外生产", path: "/products/brands/overseas" }] }
                    ]
                },
                {
                    title: "排行榜", path: "/rankings", type: "mega", gridCols: "grid-cols-6",
                    sections: [
                        { header: "性能榜", items: [{ title: "综合性能 TOP 榜", path: "/rankings/performance" }, { title: "高效率榜", path: "/rankings/efficiency" }, { title: "天然气内燃机发电效率排行榜", path: "/rankings/engine-efficiency" }, { title: "天然气内燃机热效率排行榜", path: "/rankings/thermal-efficiency" }, { title: "天然气内燃机耗气量排行榜", path: "/rankings/gas-consumption" }] },
                        { header: "经济性榜", items: [{ title: "最佳 ROI 榜", path: "/rankings/roi" }, { title: "最低发电成本 LCOE 榜", path: "/rankings/lcoe" }, { title: "天然气内燃机折旧排行榜", path: "/rankings/depreciation" }, { title: "天然气内燃机投资回报率排行榜", path: "/rankings/engine-roi" }] },
                        { header: "可靠性榜", items: [{ title: "高可靠机组榜", path: "/rankings/reliability" }, { title: "最长 MTBF 榜", path: "/rankings/mtbf" }, { title: "天然气内燃机保养时间排行榜", path: "/rankings/maintenance-interval" }, { title: "天然气内燃机备件保障排行榜", path: "/rankings/spare-parts" }] },
                        { header: "品质与环保榜", items: [{ title: "天然气内燃机排放排行榜", path: "/rankings/emissions" }, { title: "天然气内燃机噪音排行榜", path: "/rankings/noise" }] },
                        { header: "系统能力榜", items: [{ title: "天然气内燃机发电机排行榜", path: "/rankings/generator" }, { title: "天然气内燃机控制系统排行榜", path: "/rankings/control-system" }] },
                        { header: "区域榜", items: [{ title: "美国市场榜", path: "/rankings/usa" }, { title: "加拿大市场榜", path: "/rankings/canada" }, { title: "中东市场榜", path: "/rankings/middle-east" }, { title: "俄罗斯市场榜", path: "/rankings/russia" }] }
                    ]
                },
                {
                    title: "应用场景", path: "/use-cases", type: "menu",
                    children: [{ title: "油气井 / 伴生气", path: "/use-cases/oilfield" }, { title: "工业与园区能源", path: "/use-cases/industrial" }, { title: "挖矿 / 数据中心", path: "/use-cases/mining" }, { title: "CHP 热电联供", path: "/use-cases/chp" }]
                },
                {
                    title: "工具箱", path: "/tools", type: "mega", gridCols: "grid-cols-5",
                    sections: [
                        { header: "经济测算工具", items: [{ title: "LCOE 成本计算器", path: "/tools/lcoe-calculator" }, { title: "ROI 回报估算器", path: "/tools/roi" }, { title: "燃气发电挖矿收益计算器", path: "/tools/mining-power-calc" }, { title: "蒙特卡洛模拟盈利分析", path: "/tools/monte-carlo-profit" }, { title: "天然气发电耗气成本分析", path: "/tools/gas-cost-analysis" }] },
                        { header: "工程与技术工具", items: [{ title: "气质适配工具", path: "/tools/gas-fit" }, { title: "排放估算工具", path: "/tools/emission" }, { title: "气体分析计算器", path: "/tools/gas-analyzer" }, { title: "能电转换计算器", path: "/tools/energy-conversion" }, { title: "天然气主要成分热值表", path: "/tools/gas-composition-heat" }] },
                        { header: "项目与选型工具", items: [{ title: "站点匹配向导", path: "/tools/site-fit" }, { title: "气源所在地分析", path: "/tools/gas-location-analysis" }, { title: "燃气发动机选型与运营经济性", path: "/tools/engine-selection" }, { title: "天然气发电机机油消耗率", path: "/tools/oil-consumption" }, { title: "车机 VS 工业机 10MW 对比分析", path: "/tools/vehicle-vs-industrial-10mw" }, { title: "多机型对比 3 年运营数据", path: "/tools/3y-compare" }] },
                        { header: "矿工专区（托管与算力分析）", items: [{ title: "挖矿收益计算器", path: "/tools/mining-income-calculator" }, { title: "矿机盈利能力计算器", path: "/tools/miner-profitability" }, { title: "矿机选购速查", path: "/tools/miner-buying-guide" }] },
                        { header: "全球支持与合规", items: [{ title: "加拿大 AECO 天然气价格预测", path: "/tools/aeco-price-forecast" }, { title: "全球物流运输推荐", path: "/tools/global-logistics" }, { title: "全球合规政策", path: "/tools/global-compliance" }] }
                    ]
                },
                {
                    title: "资料中心", path: "/resources", type: "mega", gridCols: "grid-cols-4",
                    sections: [
                        { header: "文档", items: [{ title: "白皮书", path: "/resources/whitepapers" }, { title: "行业报告", path: "/resources/reports" }] },
                        { header: "案例", items: [{ title: "全部案例", path: "/resources/case-studies" }, { title: "按区域查看", path: "/resources/case-studies/regions" }, { title: "按场景查看", path: "/resources/case-studies/scenarios" }] },
                        { header: "技术库", items: [{ title: "技术参数表", path: "/resources/datasheets" }, { title: "认证与合规文件", path: "/resources/certifications" }] },
                        { header: "媒体与支持", items: [{ title: "视频与教程", path: "/resources/videos" }, { title: "常见问答 FAQ", path: "/resources/faq" }] }
                    ]
                },
                {
                    title: "服务支持", path: "/support", type: "menu",
                    children: [{ title: "服务网络", path: "/support/network" }, { title: "技术支持", path: "/support/tech" }, { title: "售后与保养", path: "/support/service" }]
                },
                {
                    title: "关于我们", path: "/about", type: "menu",
                    children: [{ title: "公司介绍", path: "/about/company" }, { title: "联系我们", path: "/about/contact" }]
                }
            ],

            i18n: {
                zh: {
                    tagline: "天然气发电挖矿助手",
                    footerTagline: "让天然气发电挖矿更简单",
                    "首页": "首页", "解决方案": "解决方案", "机型库": "机型库", "排行榜": "排行榜", "应用场景": "应用场景",
                    "工具箱": "工具箱", "资料中心": "资料中心", "服务支持": "服务支持", "关于我们": "关于我们", "联系我们": "联系我们",
                    // ... [Menu translations same as previous file] ...
                    "油气井/伴生气发电": "油气井/伴生气发电", "工业园区与分布式能源": "工业园区与分布式能源", "数据中心 / 挖矿电力": "数据中心 / 挖矿电力", "热电联供 CHP": "热电联供 CHP",
                    "按功率分类": "按功率分类", "按冷却方式": "按冷却方式", "按气源类型": "按气源类型", "按部署形式": "按部署形式", "按品牌": "按品牌",
                    "小于 500 kW": "小于 500 kW", "500 – 1,000 kW": "500 – 1,000 kW", "1 MW 以上": "1 MW 以上",
                    "风冷": "风冷", "液冷": "液冷", "天然气": "天然气", "伴生气": "伴生气", "低甲烷值气": "低甲烷值气",
                    "集装箱机组": "集装箱机组", "一体化机组 AIS": "一体化机组 AIS", "滑撬式机组": "滑撬式机组",
                    "全部品牌": "全部品牌", "中国生产": "中国生产", "海外生产": "海外生产",
                    // Page Specific
                    pageTitle: "机油消耗率深度分析",
                    heroTitle: "机油消耗率深度分析",
                    heroDesc: "针对 MWM、Jenbacher、CAT 及国产品牌的深度数据分析，用精准数据优化您的运营成本。",
                    badgeLow: "数值越低越好 (OPEX)", badgeInterval: "关注换油周期",
                    chartTitle: "机油消耗率对比 (g/kWh)",
                    btnAll: "全部", btnImport: "进口品牌", btnDomestic: "国产品牌",
                    chartNote: "// 数据基于 300kW 以上标准工况",
                    calcTitle: "成本节省计算器",
                    calcDesc: "计算 0.1 g/kWh 的能效差异带来的财务影响。",
                    labelPower: "机组功率 (kW)", labelHours: "年运行小时", labelPrice: "机油单价 ($/L)",
                    resVol: "节省机油量", resMoney: "年节省费用",
                    colBrand: "品牌", colModel: "型号", colPower: "功率", colOil: "消耗 (g/kWh)"
                },
                en: {
                    tagline: "Natural Gas Power Mining Assistant",
                    footerTagline: "Making natural gas power mining easier",
                    "首页": "Home", "解决方案": "Solutions", "机型库": "Products", "排行榜": "Rankings", "应用场景": "Use Cases",
                    "工具箱": "Tools", "资料中心": "Resources", "服务支持": "Support", "关于我们": "About Us", "联系我们": "Contact Us",
                    "油气井/伴生气发电": "Oil & Gas Power", "工业园区与分布式能源": "Industrial Power", "数据中心 / 挖矿电力": "Data Center / Mining", "热电联供 CHP": "CHP Cogeneration",
                    "按功率分类": "By Power", "按冷却方式": "By Cooling", "按气源类型": "By Gas Type", "按部署形式": "By Deployment", "按品牌": "By Brand",
                    "小于 500 kW": "< 500 kW", "500 – 1,000 kW": "500 – 1,000 kW", "1 MW 以上": "1 MW+",
                    "风冷": "Air Cooled", "液冷": "Liquid Cooled", "天然气": "Natural Gas", "伴生气": "Associated Gas", "低甲烷值气": "Low Methane Gas",
                    "集装箱机组": "Containerized", "一体化机组 AIS": "Integrated (AIS)", "滑撬式机组": "Skid Mounted",
                    "全部品牌": "All Brands", "中国生产": "Made in China", "海外生产": "Overseas Brands",
                    // Page Specific
                    pageTitle: "Oil Consumption Analytics",
                    heroTitle: "Oil Consumption Analytics",
                    heroDesc: "Advanced analysis of MWM, Jenbacher, CAT, and other major gas engines. Optimize your OPEX with precision data.",
                    badgeLow: "Lower is Better (OPEX)", badgeInterval: "Oil Change Interval",
                    chartTitle: "Consumption Comparison (g/kWh)",
                    btnAll: "All", btnImport: "Import", btnDomestic: "Domestic",
                    chartNote: "// Data based on >300kW Standard Conditions",
                    calcTitle: "Cost Savings Simulator",
                    calcDesc: "Calculate financial impact of 0.1 g/kWh efficiency difference.",
                    labelPower: "Power (kW)", labelHours: "Hours/Year", labelPrice: "Oil Price ($/L)",
                    resVol: "Oil Volume Saved", resMoney: "Annual Cost Saved",
                    colBrand: "Brand", colModel: "Model", colPower: "Power", colOil: "Oil (g/kWh)"
                },
                ru: {
                    tagline: "Помощник по газовому майнингу",
                    footerTagline: "Майнинг на газе проще",
                    "首页": "Главная", "解决方案": "Решения", "机型库": "Продукты", "排行榜": "Рейтинги", "应用场景": "Кейсы",
                    "工具箱": "Инструменты", "资料中心": "Ресурсы", "服务支持": "Поддержка", "关于我们": "О нас", "联系我们": "Контакты",
                    "油气井/伴生气发电": "Нефтегаз", "工业园区与分布式能源": "Пром. энергия", "数据中心 / 挖矿电力": "Майнинг", "热电联供 CHP": "Когенерация",
                    "按功率分类": "По мощности", "按冷却方式": "По охлаждению", "按气源类型": "По типу газа", "按部署形式": "По типу", "按品牌": "По бренду",
                    "小于 500 kW": "< 500 кВт", "500 – 1,000 kW": "500 – 1,000 кВт", "1 MW 以上": "1 МВт+",
                    "风冷": "Воздушное", "液冷": "Жидкостное", "天然气": "Природный газ", "伴生气": "Попутный газ", "低甲烷值气": "Низкий метан",
                    "集装箱机组": "Контейнерные", "一体化机组 AIS": "Интегрированные", "滑撬式机组": "На раме",
                    "全部品牌": "Все бренды", "中国生产": "Китай", "海外生产": "Зарубежные",
                    // Page Specific
                    pageTitle: "Аналитика масла",
                    heroTitle: "Аналитика потребления масла",
                    heroDesc: "Глубокий анализ MWM, Jenbacher, CAT и других двигателей. Оптимизируйте OPEX с точными данными.",
                    badgeLow: "Ниже - лучше (OPEX)", badgeInterval: "Интервал замены",
                    chartTitle: "Сравнение расхода (г/кВтч)",
                    btnAll: "Все", btnImport: "Импорт", btnDomestic: "Местные",
                    chartNote: "// Данные для >300кВт при станд. условиях",
                    calcTitle: "Калькулятор экономии",
                    calcDesc: "Расчет финансового влияния разницы в 0.1 г/кВтч.",
                    labelPower: "Мощность (кВт)", labelHours: "Часы/Год", labelPrice: "Цена масла ($/л)",
                    resVol: "Экономия масла", resMoney: "Экономия в год",
                    colBrand: "Бренд", colModel: "Модель", colPower: "Мощность", colOil: "Масло (г/кВтч)"
                }
            }
        };

        const app = {
            currentLang: 'en',
            isMobileMenuOpen: false,

            init() {
                this.renderNav();
                this.renderFooter();
                this.setLanguage('en'); // Init lang & static text
                
                // Back to Top Scroll Logic
                window.onscroll = () => {
                    const btn = document.getElementById('backToTopBtn');
                    if (document.body.scrollTop > 100 || document.documentElement.scrollTop > 100) {
                        btn.classList.remove('translate-y-20', 'opacity-0');
                    } else {
                        btn.classList.add('translate-y-20', 'opacity-0');
                    }
                };

                // Init Charts & Calcs
                initChart();
                populateTable();
                calculateSavings();
            },

            setLanguage(lang) {
                this.currentLang = lang;
                
                ['zh', 'en', 'ru'].forEach(l => {
                    const btn = document.getElementById(`btn-lang-${l}`);
                    const mobBtn = document.getElementById(`mob-btn-lang-${l}`);
                    
                    const activeClass = "text-black bg-gas-green shadow-glow font-bold";
                    const inactiveClass = "text-gas-subtext hover:text-white hover:bg-white/5 font-medium";
                    const mobActiveClass = "text-black bg-gas-green font-bold";
                    const mobInactiveClass = "text-gray-400 font-medium";

                    if (btn) btn.className = `px-2 py-1 rounded-full text-[10px] transition-all w-8 text-center ${l === lang ? activeClass : inactiveClass}`;
                    if (mobBtn) mobBtn.className = `px-4 py-2 rounded-full text-xs transition-all ${l === lang ? mobActiveClass : mobInactiveClass}`;
                });

                this.renderNav(); // Re-render nav for translated items
                this.renderMobileNav();
                this.renderFooter();
                this.updateStaticText();
                
                // Re-render Page Components
                populateTable();
            },

            t(key) {
                const dict = AppData.i18n[this.currentLang];
                return (dict && dict[key]) ? dict[key] : key;
            },

            updateStaticText() {
                // Header & Footer Static
                const taglineEl = document.getElementById('header-tagline');
                const footerTaglineEl = document.querySelector('[data-i18n="footerTagline"]');
                if(taglineEl) taglineEl.innerText = this.t('tagline');
                if(footerTaglineEl) footerTaglineEl.innerText = this.t('footerTagline');
                
                // Page Static Content
                document.querySelectorAll('[data-i18n]').forEach(el => {
                    const key = el.getAttribute('data-i18n');
                    if (key !== 'footerTagline') {
                        el.innerText = this.t(key);
                    }
                });
            },

            toggleMobileMenu() {
                this.isMobileMenuOpen = !this.isMobileMenuOpen;
                const menu = document.getElementById('mobile-menu-container');
                const btnIcon = document.querySelector('#mobile-menu-btn i');
                
                if (this.isMobileMenuOpen) {
                    menu.classList.remove('translate-x-full');
                    btnIcon.classList.remove('fa-bars');
                    btnIcon.classList.add('fa-xmark');
                    document.body.style.overflow = 'hidden';
                    this.renderMobileNav();
                } else {
                    menu.classList.add('translate-x-full');
                    btnIcon.classList.remove('fa-xmark');
                    btnIcon.classList.add('fa-bars');
                    document.body.style.overflow = '';
                }
            },

            toggleMobileSubmenu(id) {
                const el = document.getElementById(id);
                const icon = document.getElementById(`icon-${id}`);
                if (el.style.maxHeight) {
                    el.style.maxHeight = null;
                    icon.classList.remove('rotate-180');
                } else {
                    el.style.maxHeight = el.scrollHeight + "px";
                    icon.classList.add('rotate-180');
                }
            },

            toggleFooter(id) {
                const el = document.getElementById(id);
                const icon = document.getElementById(`footer-icon-${id}`);
                if (el.style.maxHeight) {
                    el.style.maxHeight = null;
                    icon.classList.remove('fa-minus');
                    icon.classList.add('fa-plus');
                    icon.classList.remove('text-gas-green');
                } else {
                    el.style.maxHeight = el.scrollHeight + "px";
                    icon.classList.remove('fa-plus');
                    icon.classList.add('fa-minus');
                    icon.classList.add('text-gas-green');
                }
            },

            renderNav() {
                const navContainer = document.getElementById('desktop-nav');
                navContainer.innerHTML = '';
                const totalItems = AppData.navigation.length;

                AppData.navigation.forEach((item, index) => {
                    if (item.type === 'link') {
                        navContainer.innerHTML += `
                            <a href="${item.path}" target="_blank" class="nav-item-link font-medium text-sm">
                                <span>${this.t(item.title)}</span>
                            </a>
                        `;
                    }
                    else if (item.type === 'menu' || item.type === 'mega') {
                        let dropContent = '';
                        let isMega = item.type === 'mega';
                        const isRightAligned = index >= totalItems - 3;
                        const posClass = isRightAligned ? 'right-0' : 'left-0';
                        
                        if (isMega) {
                            const gridClass = item.gridCols || 'grid-cols-5';
                            const sectionsHtml = item.sections.map((section, idx) => {
                                const isLast = idx === item.sections.length - 1;
                                const borderClass = isLast ? '' : 'border-r border-white/5';
                                const itemsHtml = section.items.map(subItem => `
                                    <li class="mb-2">
                                        <a href="${subItem.path}" target="_blank" class="text-gray-400 hover:text-gas-green text-xs flex items-center gap-2 transition-colors">
                                            <i class="fa-solid fa-angle-right text-[10px] opacity-50"></i>
                                            ${this.t(subItem.title)}
                                        </a>
                                    </li>
                                `).join('');
                                return `<div class="col-span-1 space-y-4 ${borderClass} px-2">
                                            <h3 class="text-gas-green font-bold text-sm uppercase tracking-wider mb-3 border-b border-white/5 pb-2">${this.t(section.header)}</h3>
                                            <ul>${itemsHtml}</ul>
                                        </div>`;
                            }).join('');
                            dropContent = `<div class="mega-menu"><div class="max-w-[1800px] mx-auto px-4 grid ${gridClass} gap-6">${sectionsHtml}</div></div>`;
                        } else {
                            const childrenHtml = item.children.map(child => `
                                <a href="${child.path}" target="_blank" class="block px-4 py-2 text-sm text-gray-400 hover:text-gas-green hover:bg-white/5 whitespace-nowrap">${this.t(child.title)}</a>
                            `).join('');
                            dropContent = `<div class="dropdown-menu ${posClass}">${childrenHtml}</div>`;
                        }

                        const parentPos = isMega ? '' : 'relative';
                        navContainer.innerHTML += `
                            <div class="group h-full flex items-center cursor-pointer ${parentPos}">
                                <span class="nav-item-link font-medium text-sm">
                                    <span>${this.t(item.title)}</span> <i class="fa-solid fa-chevron-down text-[10px] ml-1"></i>
                                </span>
                                ${dropContent}
                            </div>
                        `;
                    }
                });
            },

            renderMobileNav() {
                const container = document.getElementById('mobile-nav-content');
                container.innerHTML = '';
                
                AppData.navigation.forEach((item, index) => {
                    if (item.type === 'link') {
                        container.innerHTML += `
                            <a href="${item.path}" target="_blank" class="block py-4 border-b border-white/10 text-lg font-medium hover:text-gas-green">
                                ${this.t(item.title)}
                            </a>
                        `;
                    } else {
                        const subId = `mob-sub-${index}`;
                        let subItemsHtml = '';
                        
                        if (item.type === 'menu') {
                            subItemsHtml = item.children.map(child => `
                                <a href="${child.path}" target="_blank" class="block py-3 pl-4 text-gray-400 border-l border-white/10 ml-2 hover:text-gas-green hover:border-gas-green text-sm">
                                    ${this.t(child.title)}
                                </a>
                            `).join('');
                        } else if (item.type === 'mega') {
                            subItemsHtml = item.sections.map(sec => `
                                <div class="py-2">
                                    <h4 class="text-gas-green text-xs font-bold uppercase mb-2 pl-4">${this.t(sec.header)}</h4>
                                    ${sec.items.map(sub => `
                                        <a href="${sub.path}" target="_blank" class="block py-2 pl-6 text-gray-400 border-l border-white/10 ml-2 hover:text-gas-green hover:border-gas-green text-sm">
                                            ${this.t(sub.title)}
                                        </a>
                                    `).join('')}
                                </div>
                            `).join('');
                        }

                        container.innerHTML += `
                            <div class="border-b border-white/10">
                                <button onclick="app.toggleMobileSubmenu('${subId}')" class="w-full py-4 flex justify-between items-center text-lg font-medium hover:text-gas-green focus:outline-none">
                                    <span>${this.t(item.title)}</span>
                                    <i id="icon-${subId}" class="fa-solid fa-chevron-down text-sm transition-transform duration-300"></i>
                                </button>
                                <div id="${subId}" class="mobile-submenu">
                                    <div class="pb-4 space-y-1">
                                        ${subItemsHtml}
                                    </div>
                                </div>
                            </div>
                        `;
                    }
                });
            },

            renderFooter() {
                const footerContainer = document.getElementById('footer-links');
                footerContainer.innerHTML = '';

                AppData.navigation.forEach((item, idx) => {
                    if (item.title === '首页') return;

                    let contentHtml = '';
                    let desktopContentHtml = '';
                    const footerSubId = `footer-sub-${idx}`;

                    if (item.type === 'menu') {
                        const links = item.children.map(child => `
                            <a href="${child.path}" target="_blank" class="footer-link hover:text-gas-green text-gray-400 mr-4 mb-2 inline-block">
                                ${this.t(child.title)}
                            </a>
                        `).join('');
                        contentHtml = `<div class="flex flex-wrap">${links}</div>`;
                    } 
                    else if (item.type === 'mega') {
                        const desktopSections = item.sections.map(section => {
                            const secTitle = this.t(section.header);
                            const secLinks = section.items.map(sub => `
                                <a href="${sub.path}" target="_blank" class="hover:text-gas-green text-gray-400 ml-2 text-xs">
                                    ${this.t(sub.title)}
                                </a>
                            `).join('<span class="text-gray-700 mx-1">|</span>');
                            
                            return `
                                <div class="flex items-baseline mr-6 mb-2">
                                    <span class="text-gas-green text-xs font-bold uppercase mr-1 whitespace-nowrap">${secTitle}:</span>
                                    <div class="flex flex-wrap">${secLinks}</div>
                                </div>
                            `;
                        }).join('');
                        
                        const mobileLinks = item.sections.map(sec => 
                            sec.items.map(sub => 
                                `<a href="${sub.path}" target="_blank" class="footer-link block pl-2 border-l border-white/10 hover:border-gas-green mb-1">${this.t(sub.title)}</a>`
                            ).join('')
                        ).join('');

                        contentHtml = `<div class="flex flex-col">${mobileLinks}</div>`;
                        desktopContentHtml = `<div class="flex flex-wrap items-center">${desktopSections}</div>`;
                    }

                    const finalDesktopHtml = desktopContentHtml || contentHtml;

                    footerContainer.innerHTML += `
                        <div class="w-full border-b border-white/5 last:border-0">
                            <!-- Desktop View -->
                            <div class="hidden md:flex py-4 items-start">
                                <div class="w-32 lg:w-48 shrink-0">
                                    <h4 class="text-white font-bold text-sm border-l-2 border-gas-green pl-3">
                                        ${this.t(item.title)}
                                    </h4>
                                </div>
                                <div class="flex-1">
                                    ${finalDesktopHtml}
                                </div>
                            </div>
                            <!-- Mobile View -->
                            <div class="md:hidden">
                                <button onclick="app.toggleFooter('${footerSubId}')" class="w-full flex justify-between items-center py-3 text-sm font-bold text-white focus:outline-none">
                                    <span class="border-l-2 border-gas-green pl-3">${this.t(item.title)}</span>
                                    <i id="footer-icon-${footerSubId}" class="fa-solid fa-plus text-xs text-gray-500 transition-transform duration-300"></i>
                                </button>
                                <div id="${footerSubId}" class="footer-accordion-content">
                                    <div class="pt-2 pl-4 pb-4 text-gray-400">
                                        ${contentHtml} 
                                    </div>
                                </div>
                            </div>
                        </div>
                    `;
                });
            },

            captureAndShare() {
                window.scrollTo(0, 0);
                
                // Use a slight delay to ensure scroll is finished
                setTimeout(() => {
                    const watermark = document.createElement('div');
                    watermark.id = 'temp-watermark';
                    Object.assign(watermark.style, {
                        position: 'absolute', top: 0, left: 0, width: '100%', height: document.body.scrollHeight + 'px',
                        zIndex: 9999, pointerEvents: 'none', display: 'flex', flexWrap: 'wrap', 
                        alignContent: 'space-around', justifyContent: 'space-around', overflow: 'hidden', opacity: '0.15'
                    });

                    const textHtml = `<div style="text-align:center; transform: rotate(-30deg); margin: 100px;">
                                        <div style="font-size: 24px; font-weight: bold; color: #5DD62C;">www.gasgx.com</div>
                                        <div style="font-size: 16px; color: #fff;">Natural Gas Power Mining Assistant</div>
                                      </div>`;
                    
                    const count = Math.ceil(document.body.scrollHeight / 400) * 3;
                    watermark.innerHTML = textHtml.repeat(count);
                    document.body.appendChild(watermark);

                    html2canvas(document.body, {
                        backgroundColor: '#0F0F0F',
                        scrollY: 0,
                        useCORS: true,
                        scale: 2
                    }).then(canvas => {
                        const link = document.createElement('a');
                        link.download = 'GasGx-Page-Capture.png';
                        link.href = canvas.toDataURL('image/png');
                        link.click();
                        document.body.removeChild(watermark);
                        this.showModal();
                    }).catch(err => {
                        console.error(err);
                        if(document.getElementById('temp-watermark')) document.body.removeChild(watermark);
                        alert('Capture failed.');
                    });
                }, 500);
            },

            showModal() {
                const modal = document.getElementById('shareModal');
                const content = modal.querySelector('div');
                modal.classList.remove('hidden');
                setTimeout(() => content.classList.remove('scale-95', 'opacity-0'), 10);
            },

            closeModal() {
                const modal = document.getElementById('shareModal');
                const content = modal.querySelector('div');
                content.classList.add('scale-95', 'opacity-0');
                setTimeout(() => modal.classList.add('hidden'), 300);
            }
        };

        // --- Page Logic (Charts & Calcs) ---
        function initChart() {
            const ctx = document.getElementById('oilChart').getContext('2d');
            const data = processChartData('all');
            
            const dataLabels = {
                id: 'dataLabels',
                afterDatasetsDraw(chart) {
                    const { ctx } = chart;
                    chart.data.datasets[0].data.forEach((val, i) => {
                        const meta = chart.getDatasetMeta(0);
                        if (!meta.hidden) {
                            const element = meta.data[i];
                            ctx.fillStyle = '#F8F8F8';
                            ctx.font = 'bold 12px Roboto';
                            ctx.textAlign = 'center';
                            ctx.fillText(val, element.x, element.y - 8);
                        }
                    });
                }
            };

            myChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: data.labels,
                    datasets: [{
                        data: data.values,
                        backgroundColor: data.colors,
                        borderRadius: 6,
                        barPercentage: 0.65,
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { display: false }, tooltip: { enabled: false } },
                    scales: {
                        y: { beginAtZero: true, grid: { color: 'rgba(255,255,255,0.05)' }, ticks: { color: '#666' } },
                        x: { grid: { display: false }, ticks: { color: '#999', font: { size: 11 } } }
                    }
                },
                plugins: [dataLabels]
            });
        }

        function processChartData(filter) {
            let filtered = engineData;
            if (filter !== 'all') filtered = engineData.filter(d => d.category === filter);
            filtered.sort((a, b) => a.val - b.val);
            const colors = filtered.map(d => d.val <= 0.20 ? '#5DD62C' : (d.val <= 0.30 ? '#337418' : '#1f3a13'));
            return { labels: filtered.map(d => `${d.brand} ${d.model}`), values: filtered.map(d => d.val), colors };
        }

        function updateChart(filter) {
            document.querySelectorAll('.gas-btn').forEach(b => b.classList.remove('active'));
            document.getElementById(`btn-${filter}`).classList.add('active');
            const data = processChartData(filter);
            myChart.data.labels = data.labels;
            myChart.data.datasets[0].data = data.values;
            myChart.data.datasets[0].backgroundColor = data.colors;
            myChart.update();
        }

        function calculateSavings() {
            const power = parseFloat(document.getElementById('input-power').value) || 0;
            const hours = parseFloat(document.getElementById('input-hours').value) || 0;
            const price = parseFloat(document.getElementById('input-price').value) || 0;
            const diffPerKwh = parseFloat(document.querySelector('input[name="diffOption"]:checked').value);
            const density = 0.88; 
            
            const litersSaved = ((power * hours * diffPerKwh) / 1000) / density;
            const moneySaved = litersSaved * price;

            document.getElementById('result-oil-diff').textContent = Math.round(litersSaved).toLocaleString();
            document.getElementById('result-money-diff').textContent = Math.round(moneySaved).toLocaleString();
        }

        function populateTable() {
            const tbody = document.getElementById('table-body');
            tbody.innerHTML = '';
            const sorted = [...engineData].sort((a,b) => a.val - b.val);
            sorted.forEach(item => {
                const tr = document.createElement('tr');
                tr.className = 'hover:bg-white/5 transition-colors';
                let valColor = item.val <= 0.2 ? 'text-gas-green font-bold' : (item.val > 0.3 ? 'text-gray-500' : 'text-white');
                tr.innerHTML = `
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-white font-medium">${item.brand}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-400">${item.model}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-400 font-mono">${item.power}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm ${valColor} font-mono">${item.val}</td>
                `;
                tbody.appendChild(tr);
            });
        }

        // Start App
        app.init();
    </script>
</body>
</html>